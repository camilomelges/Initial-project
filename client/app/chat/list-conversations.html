<div class="page page-table page-chat">
  <div class="panel panel-default">
    <div class="panel-body">
      <div class="row">
        <div class="col-xs-12 col-sm-4">
          <uib-tabset active="ctrl.activeTab" justified="true" class="ui-tab p-t-10">

            <!--Opened Chats-->
            <uib-tab index="ctrl.openChatString" style="min-width: 100px;" ng-click="clickOpenChats()" heading="Em aberto">
              <div class="search-conversation">
                <div class="box-search">
                  <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                    <input type="text" ng-model="search" class="form-control"
                           placeholder="Pesquise pelo nome">
                  </div>
                </div>
              </div>

              <ul id="mCSB_conversation_open" class="conversations-list">
                <li ng-click="openChat(item._id, ctrl.openChatString)" class="row conversation-item"
                    ng-class="{'selected-chat': refId == item._id}"
                    ng-repeat="item in openChats | filter:{customer:{fullname:search}}">

                  <div class="col-xs-3">
                    <img src="https://s3-sa-east-1.amazonaws.com/automobi-assets/avatar-cinza.png" class="img-responsive">
                  </div>

                  <div class="col-xs-9 no-padding">
                    <h4>{{item.customer.fullname}}</h4>
                    <p class="not-breakeable">{{item.lastMsg}}</p>
                    <small ng-show="!item.readInCRM" style="color: red"><i>Existem mensagens não lidas</i></small>
                  </div>
                </li>
                <li class="row" ng-if="listIsEmpty(false, 'openChats')">
                  <p style="text-align: center;">Nenhuma conversa em aberto.</p>
                </li>
              </ul>
            </uib-tab>

            <!--My Chats-->
            <uib-tab index="ctrl.myChatString" style="min-width: 100px;" ng-click="clickMyChats()" heading="Meus Chats">

              <div class="search-conversation">
                <div class="box-search">
                  <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                    <input type="text" ng-model="search" class="form-control"
                           placeholder="Pesquise pelo nome">
                  </div>
                </div>
              </div>

              <ul id="mCSB_conversation_my_chats" class="conversations-list">

                <li class="row conversation-item" ng-click="openChat(item._id, ctrl.myChatString)"
                    ng-repeat="item in myChats | filter:{customer:{fullname:search}}"
                    ng-class="{'selected-chat': refId == item._id}">

                  <div class="col-xs-3">
                    <img src="https://s3-sa-east-1.amazonaws.com/automobi-assets/avatar-cinza.png" class="img-responsive">
                  </div>

                  <div class="col-xs-9 no-padding">
                    <h4>{{item.customer.fullname}}</h4>
                    <p>{{item.lastMsg}}</p>
                    <small ng-show="!item.readInCRM" style="color: red"><i>Existem mensagens não lidas</i></small>
                  </div>
                </li>
                <li class="row" ng-if="listIsEmpty(false, 'myChats')">
                  <p style="text-align: center;">Nenhuma conversa em aberto.</p>
                </li>
              </ul>
            </uib-tab>

            <!--Closed Chats-->
            <uib-tab index="ctrl.closedChatString"  ng-click="clickClosedChats()" heading="Fechados">
              <div class="search-conversation">
                <div class="box-search">
                  <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                    <input type="text" ng-model="search" class="form-control"
                           placeholder="Pesquise pelo nome">
                  </div>
                </div>
              </div>

              <ul id="mCSB_conversation_closed" class="conversations-list">
                <li class="row conversation-item" ui-sref="chat.view({id: item._id})"
                    ng-class="{'selected-chat': refId == item._id}"
                    ng-repeat="item in closedChats | filter:{customer:{fullname:search}}">

                  <div class="col-xs-3">
                    <img src="https://s3-sa-east-1.amazonaws.com/automobi-assets/avatar-cinza.png" class="img-responsive">
                  </div>

                  <div class="col-xs-9 no-padding">
                    <h4>{{item.customer.fullname}}</h4>
                    <p class="not-breakeable">{{item.lastMsg}}</p>
                    <small ng-show="!item.readInCRM" style="color: red"><i>Existem mensagens não lidas</i></small>
                  </div>
                </li>
                <li class="row" ng-if="listIsEmpty(true, 'closedChats')">
                  <p style="text-align: center;">Nenhuma conversa fechada.</p>
                </li>
              </ul>
            </uib-tab>

          </uib-tabset>
        </div>
        <div class="col-xs-12 col-sm-8">
          <div ng-show="showMessageWhenNotSelected()" class="flex-container">
            <h4>
              SELECIONE UMA CONVERSA PARA VISUALIZAR
            </h4>
          </div>
          <ui-view></ui-view>
        </div>
      </div>
    </div>
  </div>
</div>

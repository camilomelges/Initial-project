<header class="top-header clearfix bg-transparent" ng-controller="ToolbarCtrl">
  <div ui-preloader></div>
  <div class="logo" ng-class="{ 'bg-dark': ['11','31'].indexOf(main.skin) >= 0 }">
    <a href="#/dashboard">
      <img class="logo-full" src="images/logoAM.png" style="width: 175px;">
      <img class="logo-simple" src="images/logo-simple.png" style="width: 46px;  margin-right: 5px;">
    </a>
  </div>
  <div class="menu-button" toggle-off-canvas>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </div>
  <div class="top-nav">
    <ul class="nav-left list-unstyled">
      <li>
        <a href="#/" data-toggle-nav-collapsed-min md-button aria-label="toggle-nav-collapsed-min"
          menu-collapsed="isMenuCollapsed" class="toggle-min"><i
        class="zmdi zmdi-menu"></i></a>
      </li>
      <li>
        <a class="md-button md-ink-ripple" href="#/dashboard"><i class="fa fa-home"></i></a>
      </li>
    </ul>
    <ul class="nav-center list-unstyled">
      <li class="dropdown text-normal nav-branch">
        <ui-select
        ng-model="ctrl.selectedBranch"
        ng-change="changeBranch(ctrl.selectedBranch)"
        theme="select2"
        style="min-width: 350px;" title="Clique para selecionar uma unidade">
        <ui-select-match placeholder="Escreva para encontrar uma unidade">
        {{$select.selected.companyName}} - {{$select.selected.partner.companyName}}
        </ui-select-match>
        <ui-select-choices repeat="item in ctrl.staffBranches | filter: $select.search">
        <span ng-bind-html="item.companyName | highlight: $select.search"></span>
        <small ng-bind-html="item.partner.companyName | highlight: $select.search"></small>
        </ui-select-choices>
        <ui-select-no-choice style="padding: 10px">
        Não foi encontrado nenhuma unidade com sua busca :(
        </ui-select-no-choice>
        </ui-select>
      </li>
    </ul>
    <ul class="nav-right pull-right list-unstyled">
      <li class="dropdown p-r-20" uib-dropdown>
        <a href="javascript:;" class="dropdown-toggle" uib-dropdown-toggle>
          <i class="fa fa-bell"></i>
          <span ng-show="notification.count > 0" class="badge badge-danger">{{notification.count}}</span>
        </a>
        <div class="with-arrow panel panel-default dropdown-menu-scaleIn pull-right" uib-dropdown-menu>
          <div ng-if="notification.count > 0">
            <ul class="list-group scroll-box " dir="ltr">
              <!--// Chat-->
              <li class="list-group-item" dir="ltr" ng-repeat="notification in notification.list track by $index">
                <div ng-if="notification.type == 'survey'">
                  <a class="media" ng-click="openNotification(notification)">
                    <span class="media-left media-icon">
                      <span class="btn-icon btn-icon-round btn-primary"><i class="zmdi zmdi-chart"></i></span>
                    </span>
                    <div class="media-body">
                      <span class="block">{{notification.body.customer.fullname}} respondeu a pesquisa:</span>
                      <span class="block notification-adjustment">"{{notification.body.question.question}}"</span>
                      <span
                      class="text-muted block">em {{notification.body.createdAt | date:'dd/MM/yyyy  - HH:mm'}}</span>
                    </div>
                  </a>
                </div>
                <div ng-if="notification.type == 'chat'">
                  <a class="media" ng-click="openNotification(notification)">
                    <span class="media-left media-icon">
                      <span class="btn-icon btn-icon-round btn-primary"><i class="fa fa-comments"></i></span>
                    </span>
                    <div class="media-body">
                      <span class="block">{{notification.body.origin.name}} {{notification.body.origin.lastname}} enviou uma nova mensagem!</span>
                      <span
                      class="text-muted block">em {{notification.body.dateCreate | date:'dd/MM/yyyy  - HH:mm'}}</span>
                    </div>
                  </a>
                </div>
                <div ng-if="notification.type == 'schedule'">
                  <a class="media" ng-click="openNotification(notification)">
                    <span class="media-left media-icon">
                      <span class="btn-icon btn-icon-round btn-success"><i class="fa fa-calendar"></i></span>
                    </span>
                    <div class="media-body">
                      <span class="block">{{notification.body.customer.fullname}} fez um novo agendamento</span>
                      <span
                      class="text-muted block">em {{notification.body.dateCreate | date:'dd/MM/yyyy  - HH:mm'}}</span>
                    </div>
                  </a>
                </div>
                <div ng-if="notification.type == 'schedulerequest'">
                  <a class="media" ng-click="openNotification(notification)">
                    <span class="media-left media-icon">
                      <span class="btn-icon btn-icon-round btn-success"><i class="fa fa-calendar"></i></span>
                    </span>
                    <div class="media-body">
                      <span class="block">{{notification.body.customer.fullname}} fez uma nova solicitação de agendamento</span>
                      <span
                      class="text-muted block">em {{notification.body.dateCreate | date:'dd/MM/yyyy - HH:mm'}}</span>
                    </div>
                  </a>
                </div>
                <div ng-if="notification.type == 'bug'">
                  <a class="media" ng-click="openNotification(notification)">
                    <span class="media-left media-icon">
                      <span class="btn-icon btn-icon-round btn-primary"><i class="fa fa-refresh"></i></span>
                    </span>
                    <div class="media-body">
                      <span class="block">Seu CRM está atualizado!</span>
                      <span class="block claimedRight p-l-0 notification-adjustment p-t-b-7">Está disponível {{notification.body.summary}}</span>
                    </div>
                  </a>
                </div>
                <p class="text-muted" style="font-size: 12px; margin-left: 45px;">Suporte Automobi em {{notification.body.finishedAt | date:'dd/MM/yyyy  - HH:mm'}}</p>
              </li>
            </ul>
          </div>
          <div ng-if="notification.count == 0">
            <ul class="list-group scroll-box " dir="rtl">
              <li class="list-group-item" dir="ltr">
                <div class="media-body">
                  <span class="block">Você não possui notificações.</span>
                </div>
              </li>
            </ul>
          </div>
          <div class="panel-footer p-0">
            <button ng-click="clearAllNotifications()"
            class="md-raised btn-w-xs md-button md-ink-ripple full-width p-10">
            <span class="ng-scope" style="color: #1a8ac6;text-transform: initial;">
              Limpar notificações
            </span>
            </button>
          </div>
        </div>
      </li>
      
      <li class="dropdown p-r-20" uib-dropdown>
        <a href="javascript:;" class="dropdown-toggle" uib-dropdown-toggle>
          <i class="fa fa-user-circle font-22"></i>
        </a>
        <ul class="with-arrow pull-right dropdown-menu-scaleIn" uib-dropdown-menu>
          <li>
            <a>
              <i class="fa fa-user ng-scope"></i>
              <span class="p-l-10">{{ctrl.fullname}}</span>
            </a>
          </li>
          <li>
            <a ng-click="changePassword()">
              <i class="fa fa-lock ng-scope"></i>
              <span class="p-l-10">Trocar senha</span>
            </a>
          </li>
          <li>
            <a ng-click="logoff()">
              <i class="fa fa-sign-in"></i>
              <span class="p-l-10" data-translate="LOG_OUT"></span>
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</header>